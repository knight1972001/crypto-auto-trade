import pandas as pd
from time import sleep
from lightweight_charts import Chart

if __name__ == "__main__":

    df1 = pd.read_csv("ohlc.csv")

    # Columns: time | price
    df2 = pd.read_csv("ticks.csv")

    chart = Chart()

    chart.set(df1)

    chart.show()
    data = [
        [1716513817207, "67698.20000000"],
        [1716513818141, "67698.20000000"],
        [1716513818143, "67698.20000000"],
        [1716513818330, "67698.20000000"],
        [1716513818509, "67698.20000000"],
        [1716513818510, "67698.20000000"],
        [1716513818511, "67698.20000000"],
        [1716513818707, "67698.20000000"],
        [1716513818708, "67698.19000000"],
        [1716513818708, "67698.19000000"],
        [1716513819012, "67698.20000000"],
        [1716513819023, "67698.20000000"],
        [1716513819308, "67698.20000000"],
        [1716513819308, "67698.20000000"],
        [1716513819582, "67698.19000000"],
        [1716513819894, "67698.19000000"],
        [1716513820118, "67698.20000000"],
        [1716513820482, "67698.20000000"],
        [1716513820485, "67698.20000000"],
        [1716513820485, "67698.20000000"],
        [1716513820485, "67698.20000000"],
        [1716513820485, "67698.20000000"],
        [1716513820485, "67698.66000000"],
        [1716513820485, "67699.83000000"],
        [1716513820485, "67699.91000000"],
        [1716513820620, "67700.69000000"],
        [1716513820620, "67700.69000000"],
        [1716513820620, "67701.46000000"],
        [1716513820917, "67701.64000000"],
        [1716513820929, "67701.64000000"],
        [1716513821812, "67701.63000000"],
        [1716513821935, "67701.64000000"],
        [1716513822587, "67701.63000000"],
        [1716513823282, "67701.64000000"],
        [1716513823282, "67701.64000000"],
        [1716513823986, "67701.63000000"],
        [1716513823986, "67701.63000000"],
        [1716513824069, "67701.64000000"],
        [1716513824257, "67701.64000000"],
        [1716513824257, "67701.64000000"],
        [1716513824257, "67701.64000000"],
        [1716513824257, "67701.64000000"],
        [1716513824258, "67701.64000000"],
        [1716513824258, "67701.64000000"],
        [1716513824258, "67701.64000000"],
        [1716513824258, "67701.64000000"],
        [1716513824258, "67701.64000000"],
        [1716513824258, "67701.64000000"],
        [1716513824258, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824260, "67701.64000000"],
        [1716513824272, "67706.20000000"],
        [1716513824275, "67706.21000000"],
        [1716513824275, "67706.21000000"],
        [1716513824275, "67706.21000000"],
        [1716513824407, "67706.20000000"],
        [1716513825715, "67706.21000000"],
        [1716513825792, "67706.21000000"],
        [1716513825792, "67706.21000000"],
        [1716513825796, "67706.21000000"],
        [1716513825798, "67708.60000000"],
        [1716513825798, "67708.82000000"],
        [1716513825798, "67709.00000000"],
        [1716513825798, "67709.73000000"],
        [1716513825860, "67709.84000000"],
        [1716513826248, "67709.83000000"],
        [1716513826278, "67709.84000000"],
        [1716513826506, "67709.83000000"],
        [1716513826643, "67709.83000000"],
        [1716513826830, "67709.84000000"],
        [1716513826840, "67709.84000000"],
        [1716513827270, "67709.84000000"],
        [1716513827273, "67709.83000000"],
        [1716513828229, "67709.84000000"],
        [1716513828696, "67709.83000000"],
        [1716513828813, "67709.84000000"],
        [1716513828813, "67709.84000000"],
        [1716513828813, "67709.84000000"],
        [1716513828813, "67709.84000000"],
        [1716513828813, "67709.84000000"],
        [1716513828813, "67709.84000000"],
    ]

    # for i, tick in df2.iterrows():
    #     print(tick)
    #     chart.update_from_tick(tick)
    #     sleep(0.03)

    for item in data:
        columns = ["time", "price"]
        item[1] = float(item[1])
        df = pd.DataFrame([item], columns=columns)
        df["time"] = pd.to_datetime(df["time"], unit="ms")
        print(df)
        for i, series in df.iterrows():
            chart.update_from_tick(series)
            sleep(0.03)
